/* File: HTML Tagged Template Literals 2
Author: Anshu Krishna
Contact: anshu.krishna5@gmail.com
Date: 24-Oct-2019 */
const HTML=function(){function e(t){const n=[];for(let e of t.attributes){const t=e.value.match(c);t&&n.push({node:e,value:e.value,match:t.map(l)})}const r=Array.from(t.childNodes);for(let e of r){if(3!==e.nodeType)continue;const t=e.nodeValue.match(c);t&&n.push({node:e,value:e.nodeValue,match:t.map(l)})}for(let r of t.children)for(let t of e(r))n.push(t);return n}function t(e){const n=[];for(let t of e.attributes){const r=t.name.match(c);r&&n.push({element:e,attr:t,match:r.map(l)})}for(let r of e.children)for(let e of t(r))n.push(e);return n}function n(e){if(e instanceof HTMLElement||e instanceof Text)return e;switch(typeof e){case"object":return Array.isArray(e)?e.map(n):document.createTextNode(JSON.stringify(e));case"function":return n(e())}return document.createTextNode(String(e))}function r(e){if(e instanceof HTMLElement)return e.textContent;if(e instanceof Text)return e.nodeValue;switch(typeof e){case"object":return JSON.stringify(e);case"function":return r(e())}return String(e)}function o(o,...l){let f=o[0];for(let e=0,t=l.length;e<t;e++)f+=`${a}${e}${o[e+1]}`;let s=document.createElement("div");s.innerHTML=f;let u=e(s);for(let e of u)switch(e.node.nodeType){case 2:{let t=String(e.value);for(let n of e.match)t=t.replace(n.replace,r(l[n.index]));e.node.nodeValue=t}break;case 3:{let t=e.value.split(c).map(e=>document.createTextNode(e)),r=e.node.parentElement;r.insertBefore(t[0],e.node);for(let o=0,a=e.match.length;o<a;o++){let a=n(l[e.match[o].index]);if(Array.isArray(a))for(let t of a)r.insertBefore(t,e.node);else r.insertBefore(a,e.node);r.insertBefore(t[o+1],e.node)}r.removeChild(e.node)}}let d=t(s);for(let e of d){let t=e.element,n=e.attr.nodeValue,o=e.attr.name;if(1===e.match.length&&i(l[e.match[0].index])&&""===o.replace(e.match[0].replace,"")){t.removeAttribute(o);for(let[n,r]of Object.entries(l[e.match[0].index]))t.setAttribute(n,r)}else{for(let t of e.match)o=o.replace(t.replace,r(l[t.index]));t.removeAttribute(e.attr.name),o&&t.setAttribute(o,n)}}return s.normalize(),1!==s.children.length?(console.error("Invalid content in the template tag"),null):s.firstChild}const a="this_is_internal_placeholder",c=new RegExp(`${a}[0-9]+`,"g"),l=e=>({replace:e,index:parseInt(e.replace(a,""))}),i=e=>"object"==typeof e&&!Array.isArray(e);return o}();